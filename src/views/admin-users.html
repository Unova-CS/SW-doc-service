<!-- src/views/admin-users.html -->
<!DOCTYPE html>
<html>
<head>
  <title>User Management - Smart-Ways</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; margin: 0; }
    .container { max-width: 800px; margin: 0 auto; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    h1 { color: #F59A23; margin: 0; }
    .nav-links a {
      margin-left: 15px;
      text-decoration: none;
      color: #F59A23;
      font-weight: bold;
    }
    .nav-links a:hover { text-decoration: underline; }
    .alert {
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 4px;
      font-weight: bold;
    }
    .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #fdf6f0; color: #d35400; }
    select, button {
      padding: 6px 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    select { background: white; }
    button {
      background: #F59A23;
      color: white;
      border: none;
      cursor: pointer;
      margin-left: 8px;
    }
    button:hover { background: #d6811f; }
    .delete-btn {
      background: #e74c3c !important;
      color: white !important;
    }
    .delete-btn:hover {
      background: #c0392b !important;
    }
    .actions {
      margin: 15px 0 20px;
    }
    .btn {
      display: inline-block;
      padding: 8px 16px;
      background: #F59A23;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-size: 14px;
      margin-right: 10px;
    }
    .btn:hover { background: #d6811f; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>User Management</h1>
      <div class="nav-links">
        <a href="/admin/dashboard">Dashboard</a>
        <a href="/auth/logout">Logout</a>
      </div>
    </div>

    <div class="actions">
      <a href="/admin/users/create" class="btn">Create User</a>
    </div>

    {{#if message}}
      <div class="alert alert-{{message.type}}">{{message.text}}</div>
    {{/if}}

    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Role</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {{#each users}}
        <tr>
          <td>{{this.username}}</td>
          <td>
            <form method="POST" action="/admin/users/{{this._id}}" style="display:inline;">
              <select name="role" onchange="this.form.submit()">
                <option value="admin" {{#if (eq this.role 'admin')}}selected{{/if}}>Admin</option>
                <option value="finance" {{#if (eq this.role 'finance')}}selected{{/if}}>Finance</option>
                <option value="staff" {{#if (eq this.role 'staff')}}selected{{/if}}>Staff</option>
              </select>
            </form>
          </td>
          <td>
            <form method="POST" action="/admin/users/{{this._id}}/password" style="display:inline;" onsubmit="return confirm('Reset password to default?')">
              <input type="hidden" name="newPassword" value="password" />
              <button type="submit">Reset Password</button>
            </form>
            {{#if (neq this.username 'admin')}}
            <form method="POST" action="/admin/users/{{this._id}}/delete" style="display:inline;" onsubmit="return confirm('Delete this user? This cannot be undone.')">
              <button type="submit" class="delete-btn">Delete</button>
            </form>
            {{/if}}
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</body>
</html>